<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Problem Depot · Convex.jl</title><meta name="title" content="Problem Depot · Convex.jl"/><meta property="og:title" content="Problem Depot · Convex.jl"/><meta property="twitter:title" content="Problem Depot · Convex.jl"/><meta name="description" content="Documentation for Convex.jl."/><meta property="og:description" content="Documentation for Convex.jl."/><meta property="twitter:description" content="Documentation for Convex.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Convex.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../introduction/installation/">Installation</a></li><li><a class="tocitem" href="../../introduction/quick_tutorial/">Quick Tutorial</a></li><li><a class="tocitem" href="../../introduction/dcp/">Extended formulations and the DCP ruleset</a></li><li><a class="tocitem" href="../../introduction/faq/">FAQ</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">General examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/general_examples/DCP_analysis/">DCP analysis</a></li><li><a class="tocitem" href="../../examples/general_examples/basic_usage/">Basic Usage</a></li><li><a class="tocitem" href="../../examples/general_examples/chebyshev_center/">Chebyshev center</a></li><li><a class="tocitem" href="../../examples/general_examples/control/">Control</a></li><li><a class="tocitem" href="../../examples/general_examples/dualization/">Dualization</a></li><li><a class="tocitem" href="../../examples/general_examples/huber_regression/">Huber regression</a></li><li><a class="tocitem" href="../../examples/general_examples/lasso_regression/">Lasso, Ridge and Elastic Net Regressions</a></li><li><a class="tocitem" href="../../examples/general_examples/logistic_regression/">Logistic regression</a></li><li><a class="tocitem" href="../../examples/general_examples/max_entropy/">Entropy Maximization</a></li><li><a class="tocitem" href="../../examples/general_examples/optimal_advertising/">Optimal advertising</a></li><li><a class="tocitem" href="../../examples/general_examples/robust_approx_fitting/">Robust approximate fitting</a></li><li><a class="tocitem" href="../../examples/general_examples/svm/">Support vector machine</a></li><li><a class="tocitem" href="../../examples/general_examples/svm_l1regularization/">SVM with L^1 regularization</a></li><li><a class="tocitem" href="../../examples/general_examples/trade_off_curves/">Regularized least-squares</a></li><li><a class="tocitem" href="../../examples/general_examples/worst_case_analysis/">Worst case risk analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Mixed integer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/mixed_integer/binary_knapsack/">Binary (or 0-1) knapsack problem</a></li><li><a class="tocitem" href="../../examples/mixed_integer/n_queens/">N queens</a></li><li><a class="tocitem" href="../../examples/mixed_integer/section_allocation/">Section Allocation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Optimization with complex variables</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/optimization_with_complex_variables/Fidelity in Quantum Information Theory/">Fidelity in quantum information theory</a></li><li><a class="tocitem" href="../../examples/optimization_with_complex_variables/phase_recovery_using_MaxCut/">Phase recovery using MaxCut</a></li><li><a class="tocitem" href="../../examples/optimization_with_complex_variables/povm_simulation/">POVM simulation</a></li><li><a class="tocitem" href="../../examples/optimization_with_complex_variables/power_flow_optimization/">Power flow optimization</a></li><li><a class="tocitem" href="../../examples/optimization_with_complex_variables/quantum_conditional_entropy/">Continuity of the quantum conditional entropy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Portfolio optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/portfolio_optimization/portfolio_optimization/">Portfolio Optimization</a></li><li><a class="tocitem" href="../../examples/portfolio_optimization/portfolio_optimization2/">Portfolio Optimization - Markowitz Efficient Frontier</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Supplemental material</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/supplemental_material/Convex.jl_intro_ISMP2015/">Convex Optimization in Julia</a></li><li><a class="tocitem" href="../../examples/supplemental_material/paper_examples/">Paper examples</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Time series</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/time_series/time_series/">Time Series Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Tomography</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tomography/tomography/">Tomography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/types/">Basic Types</a></li><li><a class="tocitem" href="../../manual/operations/">Supported Operations</a></li><li><a class="tocitem" href="../../manual/complex-domain_optimization/">Complex-domain Optimization</a></li><li><a class="tocitem" href="../../manual/solvers/">Solvers</a></li><li><a class="tocitem" href="../../manual/performance_tips/">Performance tips</a></li><li><a class="tocitem" href="../../manual/advanced/">Advanced Features</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Problem Depot</a><ul class="internal"><li><a class="tocitem" href="#How-to-write-a-ProblemDepot-problem"><span>How to write a ProblemDepot problem</span></a></li><li><a class="tocitem" href="#Benchmark-only-problems"><span>Benchmark-only problems</span></a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../credits/">Credits</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/api/">API</a></li><li><a class="tocitem" href="../../reference/atoms/">Supported operations</a></li></ul></li><li><a class="tocitem" href="../../release_notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Docs</a></li><li class="is-active"><a href>Problem Depot</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Problem Depot</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jump-dev/Convex.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jump-dev/Convex.jl/blob/master/docs/src/developer/problem_depot.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Problem-Depot"><a class="docs-heading-anchor" href="#Problem-Depot">Problem Depot</a><a id="Problem-Depot-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Depot" title="Permalink"></a></h1><p>Convex.jl has a submodule, <code>ProblemDepot</code> which holds a collection of convex optimization problems. The problems are used by Convex itself to test and benchmark its code, but can also be used by solvers to test and benchmark their code. These tests have been used with many solvers at <a href="https://github.com/ericphanson/ConvexTests.jl">ConvexTests.jl</a>.</p><p>ProblemDepot has two main methods for accessing these problems: <code>Convex.ProblemDepot.run_tests</code> and <code>Convex.ProblemDepot.benchmark_suite</code>.</p><p>For example, to test the solver SCS on all the problems of the depot except the mixed-integer problems (which it cannot handle), run</p><pre><code class="language-julia hljs">using Convex, SCS, Test
const MOI = Convex.MOI
@testset &quot;SCS&quot; begin
    Convex.ProblemDepot.run_tests(; exclude=[r&quot;mip&quot;]) do p
        solve!(p, MOI.OptimizerWithAttributes(SCS.Optimizer, &quot;verbose&quot; =&gt; 0, &quot;eps_abs&quot; =&gt; 1e-6))
    end
end</code></pre><h2 id="How-to-write-a-ProblemDepot-problem"><a class="docs-heading-anchor" href="#How-to-write-a-ProblemDepot-problem">How to write a ProblemDepot problem</a><a id="How-to-write-a-ProblemDepot-problem-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-write-a-ProblemDepot-problem" title="Permalink"></a></h2><p>The problems are organized into folders in <code>src/problem_depot/problems</code>. Each is written as a function, annotated by <code>@add_problem</code>, and a name, which is used to group the problems. For example, here is a simple problem:</p><pre><code class="language-julia hljs">@add_problem affine function affine_negate_atom(handle_problem!, ::Val{test}, atol, rtol, ::Type{T}) where {T, test}
    x = Variable()
    p = minimize(-x, [x &lt;= 0])
    if test
        @test vexity(p) == AffineVexity()
    end
    handle_problem!(p)
    if test
        @test p.optval ≈ 0 atol=atol rtol=rtol
        @test evaluate(-x) ≈ 0 atol=atol rtol=rtol
    end
end</code></pre><p>The <code>@add_problem</code> call adds the problem to the registry of problems in <a href="../../reference/api/#Convex.ProblemDepot.PROBLEMS"><code>Convex.ProblemDepot.PROBLEMS</code></a>, which in turn is used by <a href="../../reference/api/#Convex.ProblemDepot.run_tests"><code>Convex.ProblemDepot.run_tests</code></a> and <a href="../../reference/api/#Convex.ProblemDepot.benchmark_suite"><code>Convex.ProblemDepot.benchmark_suite</code></a>. Next, <code>affine</code> is the grouping of the problem; this problem came from one of the affine tests, and in particular is testing the negation atom. Next is the function signature:</p><pre><code class="language-julia hljs">function affine_negate_atom(handle_problem!, ::Val{test}, atol, rtol, ::Type{T}) where {T, test}</code></pre><p>this should be the same for every problem, except for the name, which is a description of the problem. It should include what kind of atoms it uses (<code>affine</code> in this case), so that certain kinds of atoms can be ruled out by the <code>exclude</code> keyword to <a href="../../reference/api/#Convex.ProblemDepot.run_tests"><code>Convex.ProblemDepot.run_tests</code></a> and <a href="../../reference/api/#Convex.ProblemDepot.benchmark_suite"><code>Convex.ProblemDepot.benchmark_suite</code></a>; for example, many solvers cannot solve mixed-integer problems, so <code>mip</code> is included in the name of such problems.</p><p>Then begins the body of the problem. It is setup like any other Convex.jl problem, only <code>handle_problem!</code> is called instead of <code>solve!</code>. This allows particular solvers to be used (via for example, choosing <code>handle_problem! = p -&gt; solve!(p, solver)</code>), or for any other function of the problem. Tests should be included and gated behind <code>if test</code> blocks, so that tests can be skipped for benchmarking, or in the case that the problem is not in fact solved during <code>handle_problem!</code>.</p><p>The fact that the problems may not be solved during <code>handle_problem!</code> brings with it a small complication: any command that assumes the problem has been solved should be behind an <code>if test</code> check. For example, in some of the problems, <code>real(evaluate(x))</code> is used, for a variable <code>x</code>; perhaps as</p><pre><code class="language-julia hljs">x_re = real(evaluate(x))
if test
    @test x_re = ...
end</code></pre><p>However, if the problem <code>x</code> is used in has not been solved, then <code>evaluate(x) === nothing</code>, and <code>real(nothing)</code> throws an error. So instead, this should be rewritten as</p><pre><code class="language-julia hljs">if test
    x_re = real(evaluate(x))
    @test x_re = ...
end</code></pre><h2 id="Benchmark-only-problems"><a class="docs-heading-anchor" href="#Benchmark-only-problems">Benchmark-only problems</a><a id="Benchmark-only-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark-only-problems" title="Permalink"></a></h2><p>To add problems for benchmarking without tests, place problems in <code>src/problem_depot/problems/benchmark</code>, and include <code>benchmark</code> in the name. These problems will be automatically skipped during <code>run_tests</code> calls. For example, to benchmark the time it takes to add an SDP constraint, we have the problem</p><pre><code class="language-julia hljs">@add_problem constraints_benchmark function sdp_constraint(handle_problem!, args...)
    p = satisfy()
    x = Variable(44, 44) # 990 vectorized entries
    push!(p.constraints, x ⪰ 0)
    handle_problem!(p)
    nothing
end</code></pre><p>However, this &quot;problem&quot; has no tests or interesting content for testing, so we skip it during testing. Note, we use <code>args...</code> in the function signature so that it may be called with the standard function signature</p><pre><code class="language-julia hljs">f(handle_problem!, ::Val{test}, atol, rtol, ::Type{T}) where {T, test}</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/advanced/">« Advanced Features</a><a class="docs-footer-nextpage" href="../contributing/">Contributing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 21 June 2024 23:58">Friday 21 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
